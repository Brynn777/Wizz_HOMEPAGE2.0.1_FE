webpackJsonp([6],{"8yEx":function(e,t){},hqHe:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Gu7T"),o=r.n(a),i=(r("Mt9h"),r("YaEn")),l=r("P9l9"),s={data:function(){return this.form=this.$form.createForm(this),{changeId:0,productInfo:{describe:"",littleDescribe:"",name:"",partner:"",productType:"",urlBackground:""},urlHost:"",uploadHost:"",tokenInfo:{key:"",token:""},listPartnerLogo:[],listAvatar:[],listProCode:[],listScreenshot:[],previewImageUrl:"",visiblePartnerLogo:!1,visibleAvatar:!1,visibleProCode:!1,visibleScreenshot:!1,productUrlBackground:[],addButtonVisible:!1,deleteButtonVisible:!1,addVisible:!0,changeVisible:!1,formItemLayout:{labelCol:{span:6},wrapperCol:{span:12},buttonCol:{lg:{span:12,offset:6}}}}},mounted:function(){var e=this;Object(l.m)().then(function(t){e.productUrlBackground=[],200==t.status&&t.data.forEach(function(t){e.productUrlBackground.push(t)})}),Object(l.n)().then(function(t){200==t.status&&(e.urlHost="https://"+t.data.domain+"/","华东"==t.data.place?e.uploadHost="//upload.qiniup.com/":"华北"==t.data.place?e.uploadHost="//upload-z1.qiniup.com/":"华南"==t.data.place&&(e.uploadHost="//upload-z2.qiniup.com/"))})},methods:{add:function(e){var t=this;e.preventDefault(),this.form.validateFields(function(e,r){if(!e){var a="";t.isArrayOrObject(r.productUrlScreenshot).length>0&&t.isArrayOrObject(r.productUrlScreenshot).forEach(function(e){a+=e.url,a+="*"}),Object(l.b)(r.productName,r.productLittleDescribe,r.productDescribe,r.productPartner,t.isEmptyArray(t.isArrayOrObject(r.productUrlPartnerLogo))[0].url,t.isEmptyArray(t.isArrayOrObject(r.productUrlAvatar))[0].url,r.productUrlBackground,a,parseInt(r.productType.split("").pop()),t.isEmptyArray(t.isArrayOrObject(r.productUrlProCode))[0].url).then(function(e){t.showHandleTip2(e,r,"添加"),t.setAddStatus()},function(e){})}})},change:function(e){var t=this;this.form.validateFields(function(r,a){if(!r){var o="";t.isArrayOrObject(a.productUrlScreenshot).length>0&&t.isArrayOrObject(a.productUrlScreenshot).forEach(function(e){o+=e.url,o+="*"}),Object(l.e)(a.productName,a.productLittleDescribe,a.productDescribe,a.productPartner,t.isEmptyArray(t.isArrayOrObject(a.productUrlPartnerLogo))[0].url,t.isEmptyArray(t.isArrayOrObject(a.productUrlAvatar))[0].url,a.productUrlBackground,o,parseInt(a.productType.split("").pop()),t.isEmptyArray(t.isArrayOrObject(a.productUrlProCode))[0].url,e).then(function(e){t.showHandleTip2(e,a,"修改")},function(e){})}})},isArrayOrObject:function(e){return"[object Array]"===Object.prototype.toString.call(e)?e=e:"[object Object]"===Object.prototype.toString.call(e)&&(e=e.fileList),e},isEmptyArray:function(e){return 0==e.length&&e.push({url:""}),e},delete:function(e){var t=this;return Object(l.h)(e).then(function(e){t.showHandleTip(e)})},setChangePage:function(e){var t=this;this.changeId=e,Object(l.r)(e).then(function(e){t.form.setFieldsValue({productName:e.data.Name,productLittleDescribe:e.data.LittleDescribe,productDescribe:e.data.Describe,productPartner:e.data.Partner,productType:"productType"+e.data.ProjectType,productUrlBackground:e.data.UrlBackground}),t.listPartnerLogo=[],e.data.UrlPartnerLogo.length>0&&t.listPartnerLogo.push({uid:e.data.UrlPartnerLogo.split("/").pop(),name:e.data.UrlPartnerLogo.split("/").pop(),url:e.data.UrlPartnerLogo}),t.listAvatar=[],e.data.UrlAvatar.length>0&&t.listAvatar.push({uid:e.data.UrlAvatar.split("/").pop(),name:e.data.UrlAvatar.split("/").pop(),url:e.data.UrlAvatar}),t.listProCode=[],e.data.UrlProCode.length>0&&t.listProCode.push({uid:e.data.UrlProCode.split("/").pop(),name:e.data.UrlProCode.split("/").pop(),url:e.data.UrlProCode}),t.listScreenshot=[],e.data.UrlScreenshot.split("*").forEach(function(e){e.length>1&&t.listScreenshot.push({uid:e.split("/").pop(),name:e.split("/").pop(),url:e})}),t.setChangeStatus()})},gotoDelete:function(){var e=this;e.$confirm({title:"删除",content:"您确认要删除本产品吗？",okText:"确认",cancelText:"取消",onOk:function(){e.delete(e.changeId)},onCancel:function(){}})},beforeUpload:function(e){var t=this,r="product-"+(new Date).getTime()+"."+e.name.split(".").pop();return Object(l.t)(r).then(function(e){t.tokenInfo.token=e.data,t.tokenInfo.key=r},function(e){})},setAddStatus:function(){this.form.resetFields(),this.listPartnerLogo=this.listAvatar=this.listProCode=this.listScreenshot=[],this.addButtonVisible=this.deleteButtonVisible=this.changeVisible=!1,this.addVisible=!0},setChangeStatus:function(){this.addButtonVisible=this.changeVisible=this.deleteButtonVisible=!0,this.addVisible=!1},showHandleTip:function(e){if(this.$message.config({top:"200px",duration:2}),200==e.status||404==e.status){this.$message.success("产品已成功删除"),this.setAddStatus()}else 401==e.status?(this.$message.error("您的身份已过期，请重新登录"),setTimeout(function(){i.a.push({name:"login"})},2e3)):504==e.status?this.$message.warning("请求超时，请稍后再试"):this.$message.warning("服务器故障，请联系管理员")},showHandleTip2:function(e,t,r){if(this.$message.config({top:"200px",duration:2}),200==e.status){var a=this;this.$message.success("产品“"+t.productName+"”已成功"+r),"添加"==r&&setTimeout(function(){a.form.resetFields()},2e3)}else 401==e.status?(this.$message.error("您的身份已过期，请重新登录"),setTimeout(function(){i.a.push({name:"login"})},2e3)):504==e.status?this.$message.warning("请求超时，请稍后再试"):this.$message.warning("服务器故障，请联系管理员")},previewPartnerLogo:function(e){this.previewImageUrl=e.url||e.thumbUrl,this.visiblePartnerLogo=!0},previewAvatar:function(e){this.previewImageUrl=e.url||e.thumbUrl,this.visibleAvatar=!0},previewProCode:function(e){this.previewImageUrl=e.url||e.thumbUrl,this.visibleProCode=!0},previewScreenshot:function(e){this.previewImageUrl=e.url||e.thumbUrl,this.visibleScreenshot=!0},cancelAvatar:function(){this.visibleAvatar=!1},cancelPartnerLogo:function(){this.visiblePartnerLogo=!1},cancelProCode:function(){this.visibleProCode=!1},cancelScreenShot:function(){this.visibleScreenshot=!1},baseUpload:function(e){var t=this,r=[].concat(o()(e.fileList));r=r.map(function(e){return e.response&&(e.url=e.thumbUrl=""+t.urlHost+e.response.key),e})},uploadPartnerLogo:function(e){this.baseUpload(e),this.listPartnerLogo=e.fileList},uploadAvatar:function(e){this.baseUpload(e),this.listAvatar=e.fileList},uploadProCode:function(e){this.baseUpload(e),this.listProCode=e.fileList},uploadScreenShot:function(e){this.baseUpload(e),this.listScreenshot=e.fileList}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-form",{staticStyle:{position:"relative"},attrs:{form:e.form,layout:"horizontal"},on:{submit:e.add}},[e.addButtonVisible?r("a-button",{staticClass:"roundButtonLeft",attrs:{shape:"circle",icon:"file-add"},on:{click:e.setAddStatus}}):e._e(),e._v(" "),e.deleteButtonVisible?r("a-button",{staticClass:"roundButtonRight",attrs:{shape:"circle",icon:"delete"},on:{click:e.gotoDelete}}):e._e(),e._v(" "),r("a-form-item",{attrs:{label:"产品名称","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["productName",{initialValue:e.productInfo.name,rules:[{required:!0,message:"产品名称是必填项"}]}],expression:"[\n          'productName',\n          { initialValue: productInfo.name,\n            rules: [{ required: true, message: '产品名称是必填项' }] }]"}],attrs:{placeholder:"请输入产品名称"}})],1),e._v(" "),r("a-form-item",{attrs:{label:"简要描述","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["productLittleDescribe",{initialValue:e.productInfo.littleDescribe,rules:[{required:!0,message:"简要描述是必填项"}]}],expression:"[\n          'productLittleDescribe',\n          { initialValue: productInfo.littleDescribe,\n            rules: [{ required: true, message: '简要描述是必填项' }] }]"}],attrs:{placeholder:"请输入简要描述"}})],1),e._v(" "),r("a-form-item",{attrs:{label:"详细介绍","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["productDescribe",{initialValue:e.productInfo.describe,rules:[{required:!0,max:50,message:"最多输入50个字"}]}],expression:"[\n          'productDescribe',\n          { initialValue: productInfo.describe,\n            rules: [{ required: true, max:50, message: '最多输入50个字' }] }]"}],attrs:{placeholder:"请输入详细介绍"}})],1),e._v(" "),r("a-form-item",{attrs:{label:"产品图标","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["productUrlAvatar",{initialValue:e.listAvatar,rules:[{required:!0,message:"产品图标是必填项"}]}],expression:"[\n          'productUrlAvatar',\n          { initialValue:listAvatar,\n          rules: [{ required: true, message: '产品图标是必填项' }] }]"}],attrs:{action:e.uploadHost,listType:"picture-card",accept:"image/*",data:e.tokenInfo,beforeUpload:e.beforeUpload,fileList:e.listAvatar},on:{change:e.uploadAvatar,preview:e.previewAvatar}},[e.listAvatar.length<1?r("div",[r("a-icon",{attrs:{type:"plus"}}),e._v(" "),r("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),e._v(" "),r("a-modal",{attrs:{visible:e.visibleAvatar,footer:null},on:{cancel:e.cancelAvatar}},[r("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImageUrl}})])],1),e._v(" "),r("a-form-item",{attrs:{label:"产品二维码","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["productUrlProCode",{initialValue:e.listProCode,rules:[{required:!1,message:""}]}],expression:"[\n          'productUrlProCode',\n          { initialValue:listProCode,\n          rules: [{ required: false, message: '' }] }\n        ]"}],attrs:{action:e.uploadHost,listType:"picture-card",accept:"image/*",data:e.tokenInfo,beforeUpload:e.beforeUpload,fileList:e.listProCode},on:{change:e.uploadProCode,preview:e.previewProCode}},[e.listProCode.length<1?r("div",[r("a-icon",{attrs:{type:"plus"}}),e._v(" "),r("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),e._v(" "),r("a-modal",{attrs:{visible:e.visibleProCode,footer:null},on:{cancel:e.cancelProCode}},[r("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImageUrl}})])],1),e._v(" "),r("a-form-item",{attrs:{label:"产品截图","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["productUrlScreenshot",{initialValue:e.listScreenshot,rules:[{required:!1,message:""}]}],expression:"[\n          'productUrlScreenshot',\n          { initialValue:listScreenshot,\n          rules: [{ required: false, message: '' }] }]"}],attrs:{action:e.uploadHost,listType:"picture-card",accept:"image/*",data:e.tokenInfo,beforeUpload:e.beforeUpload,fileList:e.listScreenshot},on:{change:e.uploadScreenShot,preview:e.previewScreenshot}},[e.listScreenshot.length<3?r("div",[r("a-icon",{attrs:{type:"plus"}}),e._v(" "),r("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),e._v(" "),r("a-modal",{attrs:{visible:e.visibleScreenshot,footer:null},on:{cancel:e.cancelScreenShot}},[r("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImageUrl}})])],1),e._v(" "),r("a-form-item",{attrs:{label:"合作方名称","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["productPartner",{initialValue:e.productInfo.partner,rules:[{required:!1,message:" "}]}],expression:"[\n        'productPartner',\n        { initialValue:productInfo.partner,\n        rules: [{ required: false, message: ' ' }] }]"}],attrs:{placeholder:"请输入合作方名称"}})],1),e._v(" "),r("a-form-item",{attrs:{label:"合作方图标","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["productUrlPartnerLogo",{initialValue:e.listPartnerLogo,rules:[{required:!1,message:""}]}],expression:"[\n          'productUrlPartnerLogo',\n          { initialValue:listPartnerLogo,\n          rules: [{ required: false, message: '' }] }]"}],attrs:{action:e.uploadHost,listType:"picture-card",accept:"image/*",data:e.tokenInfo,beforeUpload:e.beforeUpload,fileList:e.listPartnerLogo},on:{preview:e.previewPartnerLogo,change:e.uploadPartnerLogo}},[e.listPartnerLogo.length<1?r("div",[r("a-icon",{attrs:{type:"plus"}}),e._v(" "),r("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),e._v(" "),r("a-modal",{attrs:{visible:e.visiblePartnerLogo,footer:null},on:{cancel:e.cancelPartnerLogo}},[r("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImageUrl}})])],1),e._v(" "),r("a-form-item",{attrs:{label:"产品属性","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[r("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["productType",{initialValue:e.productInfo.productType,rules:[{required:!0,message:"产品属性是必填项"}]}],expression:"[\n        'productType',\n        { initialValue:productInfo.productType,\n        rules: [{ required: true, message: '产品属性是必填项' }] }\n      ]"}]},[r("a-radio",{attrs:{value:"productType0"}},[e._v("校企合作")]),e._v(" "),r("a-radio",{attrs:{value:"productType1"}},[e._v("校园合作")]),e._v(" "),r("a-radio",{attrs:{value:"productType2"}},[e._v("校内自研")])],1)],1),e._v(" "),r("a-form-item",{attrs:{label:"背景","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol}},[r("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["productUrlBackground",{initialValue:e.productInfo.urlBackground,rules:[{required:!0,message:"请选择一张背景"}]}],expression:"[\n        'productUrlBackground',\n        { initialValue:productInfo.urlBackground,\n          rules: [{ required: true, message: '请选择一张背景' }] }\n      ]"}]},[r("a-row",{staticStyle:{"text-align":"center"},attrs:{gutter:16}},e._l(e.productUrlBackground,function(t,a){return r("a-col",{key:"back"+a,attrs:{span:6}},[r("label",{attrs:{for:"img"+a}},[r("img",{staticClass:"backImage",attrs:{src:e.productUrlBackground[a],alt:"背景"}})]),e._v(" "),r("a-radio",{attrs:{value:e.productUrlBackground[a],id:"img"+a}})],1)}),1)],1)],1),e._v(" "),r("a-form-item",{attrs:{"wrapper-col":e.formItemLayout.buttonCol}},[e.addVisible?r("a-button",{staticClass:"bulkButton",attrs:{"html-type":"submit",type:"primary"}},[e._v("添加产品")]):e._e(),e._v(" "),e.changeVisible?r("a-button",{staticClass:"bulkButton",attrs:{type:"primary"},on:{click:function(t){return e.change(e.changeId)}}},[e._v("修改产品")]):e._e()],1)],1)],1)},staticRenderFns:[]};var u=r("VU/8")(s,n,!1,function(e){r("8yEx")},"data-v-375ecbb5",null);t.default=u.exports}});